# Refactoring Batch 2 of 6

> **ðŸ“‹ REFACTORING REQUIREMENT FILE**
> Project: GOAT
> Issues in this batch: 20
> Generated by Vibeman RefactorWizard

---

## Overview

This batch contains **20 refactoring opportunities** to address.
Please work through each issue systematically, ensuring tests pass after each change.

### Summary

**By Category:**
- maintainability: 10
- code-quality: 3
- duplication: 7

**By Severity:**
- high: 6
- medium: 14

---

## Issues to Address

### 1. Deep conditional nesting in src/hooks/useSwipeGesture.ts

**Category**: maintainability | **Severity**: high | **Effort**: medium

**Description**:
Found 3 deeply nested conditional blocks (>3 levels). Consider using early returns, guard clauses, or extracting to functions.

**Impact**:
Improves code readability and reduces cognitive complexity

**Files Affected**:
- `src/hooks/useSwipeGesture.ts`

**Line Numbers**:
- src/hooks/useSwipeGesture.ts: lines 65, 68, 119

---

### 2. Deep conditional nesting in src/lib/gestures/useSwipeGesture.ts

**Category**: maintainability | **Severity**: high | **Effort**: medium

**Description**:
Found 2 deeply nested conditional blocks (>3 levels). Consider using early returns, guard clauses, or extracting to functions.

**Impact**:
Improves code readability and reduces cognitive complexity

**Files Affected**:
- `src/lib/gestures/useSwipeGesture.ts`

**Line Numbers**:
- src/lib/gestures/useSwipeGesture.ts: lines 56, 59

---

### 3. Large file detected: src/hooks/useSupabaseAuth.ts

**Category**: maintainability | **Severity**: high | **Effort**: high

**Description**:
This file has 504 lines. Consider splitting it into smaller, more focused modules. Target: Keep files under 200 lines for better maintainability.

**Impact**:
Improves code organization, readability, and maintainability

**Files Affected**:
- `src/hooks/useSupabaseAuth.ts`

---

### 4. 'any' type usage in src/hooks/useLoadingStateMachine.ts

**Category**: code-quality | **Severity**: medium | **Effort**: medium

**Description**:
Found 6 uses of 'any' type. Consider using proper TypeScript types for better type safety.

**Impact**:
Improves type safety and prevents runtime errors

**Files Affected**:
- `src/hooks/useLoadingStateMachine.ts`

**Line Numbers**:
- src/hooks/useLoadingStateMachine.ts: lines 31, 39, 176, 210, 292, 389

---

### 5. 'any' type usage in src/lib/hooks/useLoadingStateMachine.ts

**Category**: code-quality | **Severity**: medium | **Effort**: medium

**Description**:
Found 6 uses of 'any' type. Consider using proper TypeScript types for better type safety.

**Impact**:
Improves type safety and prevents runtime errors

**Files Affected**:
- `src/lib/hooks/useLoadingStateMachine.ts`

**Line Numbers**:
- src/lib/hooks/useLoadingStateMachine.ts: lines 31, 39, 176, 230, 333, 430

---

### 6. 'any' type usage in src/app/features/Match/sub_MatchGrid/components/DragComponents.tsx

**Category**: code-quality | **Severity**: medium | **Effort**: medium

**Description**:
Found 5 uses of 'any' type. Consider using proper TypeScript types for better type safety.

**Impact**:
Improves type safety and prevents runtime errors

**Files Affected**:
- `src/app/features/Match/sub_MatchGrid/components/DragComponents.tsx`

**Line Numbers**:
- src/app/features/Match/sub_MatchGrid/components/DragComponents.tsx: lines 6, 33, 34, 35, 36

---

### 7. Complex boolean expressions in src/hooks/useLoadingStateMachine.ts

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 2 complex conditions with multiple logical operators. Consider extracting to named boolean variables.

**Impact**:
Improves code readability and maintainability

**Files Affected**:
- `src/hooks/useLoadingStateMachine.ts`

**Line Numbers**:
- src/hooks/useLoadingStateMachine.ts: lines 63, 74

âœ… **Auto-fix available**

---

### 8. Complex boolean expressions in src/lib/hooks/useLoadingStateMachine.ts

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 2 complex conditions with multiple logical operators. Consider extracting to named boolean variables.

**Impact**:
Improves code readability and maintainability

**Files Affected**:
- `src/lib/hooks/useLoadingStateMachine.ts`

**Line Numbers**:
- src/lib/hooks/useLoadingStateMachine.ts: lines 63, 74

âœ… **Auto-fix available**

---

### 9. Complex boolean expressions in src/app/features/Match/sub_MatchGrid/SimpleMatchGrid.tsx

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 2 complex conditions with multiple logical operators. Consider extracting to named boolean variables.

**Impact**:
Improves code readability and maintainability

**Files Affected**:
- `src/app/features/Match/sub_MatchGrid/SimpleMatchGrid.tsx`

**Line Numbers**:
- src/app/features/Match/sub_MatchGrid/SimpleMatchGrid.tsx: lines 114, 125

âœ… **Auto-fix available**

---

### 10. Code duplication in src/hooks/use-top-lists.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 50 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/hooks/use-top-lists.ts`

âœ… **Auto-fix available**

---

### 11. Code duplication in src/hooks/use-temp-user.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 6 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/hooks/use-temp-user.ts`

âœ… **Auto-fix available**

---

### 12. Deep conditional nesting in src/hooks/use-progressive-wiki-image.ts

**Category**: maintainability | **Severity**: high | **Effort**: medium

**Description**:
Found 3 deeply nested conditional blocks (>3 levels). Consider using early returns, guard clauses, or extracting to functions.

**Impact**:
Improves code readability and reduces cognitive complexity

**Files Affected**:
- `src/hooks/use-progressive-wiki-image.ts`

**Line Numbers**:
- src/hooks/use-progressive-wiki-image.ts: lines 72, 73, 74

---

### 13. Magic numbers in src/hooks/use-progressive-wiki-image.ts

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 1 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/hooks/use-progressive-wiki-image.ts`

**Line Numbers**:
- src/hooks/use-progressive-wiki-image.ts: lines 55

âœ… **Auto-fix available**

---

### 14. Magic numbers in src/hooks/use-leaderboard.ts

**Category**: maintainability | **Severity**: high | **Effort**: low

**Description**:
Found 3 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/hooks/use-leaderboard.ts`

**Line Numbers**:
- src/hooks/use-leaderboard.ts: lines 34, 34, 35

âœ… **Auto-fix available**

---

### 15. Code duplication in src/hooks/use-item-stats.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 4 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/hooks/use-item-stats.ts`

âœ… **Auto-fix available**

---

### 16. Code duplication in src/hooks/use-item-groups.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 5 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/hooks/use-item-groups.ts`

âœ… **Auto-fix available**

---

### 17. Magic numbers in src/hooks/use-item-groups.ts

**Category**: maintainability | **Severity**: high | **Effort**: low

**Description**:
Found 7 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/hooks/use-item-groups.ts`

**Line Numbers**:
- src/hooks/use-item-groups.ts: lines 92, 92, 137, 137, 142, 169, 176

âœ… **Auto-fix available**

---

### 18. Code duplication in src/hooks/use-challenges.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 4 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/hooks/use-challenges.ts`

âœ… **Auto-fix available**

---

### 19. Code duplication in src/stores/backlog/actions-utils.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 8 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/backlog/actions-utils.ts`

âœ… **Auto-fix available**

---

### 20. Code duplication in src/stores/backlog/actions-offline.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 6 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/backlog/actions-offline.ts`

âœ… **Auto-fix available**

---

## Validation Checklist

- [ ] All 20 issues addressed
- [ ] Tests passing (`npm test`)
- [ ] Type checking passing (`npx tsc --noEmit`)
- [ ] No new linting errors
- [ ] Changes committed with descriptive messages

---

**Batch**: 2 of 6
**Total Issues**: 20
