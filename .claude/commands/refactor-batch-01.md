# Refactoring Batch 1 of 6

> **ðŸ“‹ REFACTORING REQUIREMENT FILE**
> Project: GOAT
> Issues in this batch: 20
> Generated by Vibeman RefactorWizard

---

## Overview

This batch contains **20 refactoring opportunities** to address.
Please work through each issue systematically, ensuring tests pass after each change.

### Summary

**By Category:**
- duplication: 11
- maintainability: 9

**By Severity:**
- medium: 15
- high: 5

---

## Issues to Address

### 1. Code duplication  (107 files)

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
This issue affects 107 files across the codebase. Found 7 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `tailwind.config.ts`
- `src/types/match.ts`
- `src/types/challenges.ts`
- `src/hooks/useSwipeGesture.ts`
- `src/hooks/useSupabaseMutation.ts`
- `src/hooks/useSupabaseAuth.ts`
- `src/hooks/useScreenCapture.ts`
- `src/hooks/useMediaQuery.ts`
- `src/hooks/useLoadingStateMachine.ts`
- `src/hooks/index.ts`

âœ… **Auto-fix available**

---

### 2. Magic numbers in scripts/log-particle-theme-implementation.ts

**Category**: maintainability | **Severity**: high | **Effort**: low

**Description**:
Found 8 magic numbers that should be extracted to named constants. Suggested names: PORT

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `scripts/log-particle-theme-implementation.ts`

**Line Numbers**:
- scripts/log-particle-theme-implementation.ts: lines 10, 10, 13, 13, 13, 14, 14, 16

âœ… **Auto-fix available**

---

### 3. Code duplication in src/types/top-lists.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 6 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/types/top-lists.ts`

âœ… **Auto-fix available**

---

### 4. Code duplication in src/types/composition-to-api.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 8 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/types/composition-to-api.ts`

âœ… **Auto-fix available**

---

### 5. Code duplication in src/types/backlog-groups.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 16 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/types/backlog-groups.ts`

âœ… **Auto-fix available**

---

### 6. Code duplication in src/stores/wiki-image-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 19 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/wiki-image-store.ts`

âœ… **Auto-fix available**

---

### 7. Code duplication in src/stores/use-list-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 14 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/use-list-store.ts`

âœ… **Auto-fix available**

---

### 8. Large file detected: src/stores/session-store.ts

**Category**: maintainability | **Severity**: high | **Effort**: high

**Description**:
This file has 541 lines. Consider splitting it into smaller, more focused modules. Target: Keep files under 200 lines for better maintainability.

**Impact**:
Improves code organization, readability, and maintainability

**Files Affected**:
- `src/stores/session-store.ts`

---

### 9. Code duplication in src/stores/session-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 46 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/session-store.ts`

âœ… **Auto-fix available**

---

### 10. Deep conditional nesting in src/stores/session-store.ts

**Category**: maintainability | **Severity**: medium | **Effort**: medium

**Description**:
Found 1 deeply nested conditional blocks (>3 levels). Consider using early returns, guard clauses, or extracting to functions.

**Impact**:
Improves code readability and reduces cognitive complexity

**Files Affected**:
- `src/stores/session-store.ts`

**Line Numbers**:
- src/stores/session-store.ts: lines 459

---

### 11. Magic numbers in src/stores/session-store.ts

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 4 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/stores/session-store.ts`

**Line Numbers**:
- src/stores/session-store.ts: lines 72, 191, 210, 496

âœ… **Auto-fix available**

---

### 12. Code duplication in src/stores/item-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 11 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/item-store.ts`

âœ… **Auto-fix available**

---

### 13. Large file detected: src/stores/grid-store.ts

**Category**: maintainability | **Severity**: high | **Effort**: high

**Description**:
This file has 520 lines. Consider splitting it into smaller, more focused modules. Target: Keep files under 200 lines for better maintainability.

**Impact**:
Improves code organization, readability, and maintainability

**Files Affected**:
- `src/stores/grid-store.ts`

---

### 14. Code duplication in src/stores/grid-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 72 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/grid-store.ts`

âœ… **Auto-fix available**

---

### 15. Magic numbers in src/stores/composition-modal-store.ts

**Category**: maintainability | **Severity**: high | **Effort**: low

**Description**:
Found 3 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/stores/composition-modal-store.ts`

**Line Numbers**:
- src/stores/composition-modal-store.ts: lines 63, 64, 65

âœ… **Auto-fix available**

---

### 16. Code duplication in src/stores/challenge-store.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 10 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/stores/challenge-store.ts`

âœ… **Auto-fix available**

---

### 17. Magic numbers  (134 files)

**Category**: maintainability | **Severity**: high | **Effort**: low

**Description**:
This issue affects 134 files across the codebase. Found 7 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/lib/youtube.ts`
- `src/hooks/useTwitterShare.ts`
- `src/hooks/useSwipeGesture.ts`
- `src/hooks/useLoadingStateMachine.ts`
- `src/lib/utils/animations.ts`
- `src/lib/providers/gemini.ts`
- `src/lib/hooks/useLoadingStateMachine.ts`
- `src/lib/gestures/useSwipeGesture.ts`
- `src/lib/api/collection.ts`
- `src/app/api/recommendation/route.ts`

âœ… **Auto-fix available**

---

### 18. Magic numbers in src/lib/theme-support.ts

**Category**: maintainability | **Severity**: medium | **Effort**: low

**Description**:
Found 1 magic numbers that should be extracted to named constants.

**Impact**:
Improves code maintainability and clarity

**Files Affected**:
- `src/lib/theme-support.ts`

**Line Numbers**:
- src/lib/theme-support.ts: lines 49

âœ… **Auto-fix available**

---

### 19. Code duplication in src/lib/badge-definitions.ts

**Category**: duplication | **Severity**: medium | **Effort**: medium

**Description**:
Found 30 duplicated code blocks that could be extracted into reusable functions.

**Impact**:
Reduces code duplication and improves maintainability

**Files Affected**:
- `src/lib/badge-definitions.ts`

âœ… **Auto-fix available**

---

### 20. Deep conditional nesting in src/hooks/useTwitterShare.ts

**Category**: maintainability | **Severity**: medium | **Effort**: medium

**Description**:
Found 2 deeply nested conditional blocks (>3 levels). Consider using early returns, guard clauses, or extracting to functions.

**Impact**:
Improves code readability and reduces cognitive complexity

**Files Affected**:
- `src/hooks/useTwitterShare.ts`

**Line Numbers**:
- src/hooks/useTwitterShare.ts: lines 28, 34

---

## Validation Checklist

- [ ] All 20 issues addressed
- [ ] Tests passing (`npm test`)
- [ ] Type checking passing (`npx tsc --noEmit`)
- [ ] No new linting errors
- [ ] Changes committed with descriptive messages

---

**Batch**: 1 of 6
**Total Issues**: 20
