You are an expert software engineer. Execute the following requirement immediately. Do not ask questions, do not wait for confirmation. Read the requirement carefully and implement all changes to the codebase as specified.

REQUIREMENT TO EXECUTE NOW:

You are an expert software engineer. Execute the following requirement immediately. Do not ask questions, do not wait for confirmation. Read the requirement carefully and implement all changes to the codebase as specified.

REQUIREMENT TO EXECUTE NOW:

# Seamless Drag-and-Drop with Snap & Animation

## Metadata
- **Category**: functionality
- **Effort**: High (3/3)
- **Impact**: High (3/3)
- **Scan Type**: feature_scout
- **Generated**: 11/23/2025, 11:37:12 AM

## Description
Integrate dnd-kit with Framer Motion to provide an inertia-driven drag experience that snaps items to a 10x10 grid. Add a lightweight server-side preview API that calculates the final positions before committing, and visual cues (shadows, highlight) during dragging. The modal’s state is synced with the global composition store so that the grid updates in real time as items are dropped.

## Reasoning
A fluid, game-like drag experience directly addresses the core design goal of a blazing-fast DND system, improving user satisfaction and reducing errors. Leveraging the existing dnd-kit context and global store keeps the codebase cohesive.

## Context

**Note**: This section provides supporting architectural documentation and is NOT a hard requirement. Use it as guidance to understand existing code structure and maintain consistency.

### Context: Showcase & List Creation

**Description**: ## Overview
The showcase and list creation system is the primary entry point of the application. It displays an animated hero section with floating showcase cards that demonstrate various ranking categories, and provides an interactive composition modal for creating new custom ranking lists. Users can click on showcase cards to open pre-filled list templates or create completely custom lists from scratch.

## Key Capabilities
- Animated Hero Section: Full-screen floating showcase with 3D card animations, parallax effects, and interactive hover states
- Showcase Cards: Pre-designed ranking examples (sports, music, games) that users can click to create similar lists
- List Composition Modal: Two-mode creation flow (Quick Create for predefined lists, Custom Mode for advanced configuration)
- Category & Time Period Selection: Choose from sports (with subcategories like Basketball), music, games, stories with all-time/decade/year filters
- Live Preview: Real-time preview of list configuration with dynamic theming based on selected category

## Architecture

### Component Breakdown
| Component/File | Purpose | Layer |
|----------------|---------|-------|
| `src/app/features/Landing/LandingLayout.tsx` | Main layout wrapper orchestrating showcase and lists sections | UI |
| `src/app/features/Landing/LandingMain.tsx` | Hero section container with background animations | UI |
| `src/app/features/Landing/FloatingShowcase.tsx` | Floating cards orchestration with Framer Motion animations | UI |
| `src/app/features/Landing/ShowcaseCard.tsx` | Individual showcase card for standard categories | UI |
| `src/app/features/Landing/BannedShowcaseCard.tsx` | Showcase card variant with banned/restricted visual treatment | UI |
| `src/app/features/Landing/ShowcaseHeader.tsx` | Hero header with title and introduction text | UI |
| `src/app/features/Landing/CompositionModal.tsx` | Main list creation modal with dual-mode interface | UI |
| `src/app/features/Landing/ListCreateButton.tsx` | Central create button with loading states and validation | UI |
| `src/hooks/use-composition.ts` | Global composition modal state management (Zustand) | State |
| `src/stores/composition-modal-store.ts` | Composition form data persistence and preset handling | State |
| `src/types/composition-to-api.ts` | Type transformations from UI form to API request format | Data |

### Data Flow
1. User lands on homepage � LandingLayout renders LandingMain (hero) + list sections
2. FloatingShowcase displays animated ShowcaseCards from showCaseExamples constant
3. User clicks showcase card � openWithPreset() populates CompositionModal with preset data
4. User modifies or accepts preset � Quick Create (predefined) or Custom Mode (expanded form)
5. Form data flows through composition-modal-store � mapCompositionToCreateListRequest()
6. API call via useCreateListWithUser() � Supabase creates list � navigate to /match-test
7. useComposition hook manages global modal state across Landing and other features

### Key Dependencies
- External: framer-motion (animations), @dnd-kit (future drag support), next/navigation (routing)
- Internal: use-top-lists (API mutations), use-temp-user (session), use-list-store (current list state), getIcons/getColors (theming)

## Technical Details

### State Management
- **Global Modal State**: useComposition hook wraps composition-modal-store (Zustand)
- **Form Persistence**: compositionData includes selectedCategory, subcategory, timePeriod, hierarchy, color
- **Preset System**: openWithPreset() pre-fills form based on clicked showcase card
- **Dual Mode**: isExpanded=false (Quick Create), isExpanded=true (Custom Mode with full form)

### API Endpoints
- POST `/api/lists` - Create new list via useCreateListWithUser mutation
- List creation returns list ID � immediately navigate to /match-test?list={id}

### Database Tables
- `top_lists` - Stores created lists with title, category, subcategory, size, time_period, user_id
- Lists are linked to temp_users or authenticated users (Clerk � Supabase migration in progress)
**Related Files**:
- `src/app/features/Landing/LandingLayout.tsx`
- `src/app/features/Landing/LandingMain.tsx`
- `src/app/features/Landing/FloatingShowcase.tsx`
- `src/app/features/Landing/ShowcaseCard.tsx`
- `src/app/features/Landing/BannedShowcaseCard.tsx`
- `src/app/features/Landing/ShowcaseHeader.tsx`
- `src/app/features/Landing/CompositionModal.tsx`
- `src/app/features/Landing/ListCreateButton.tsx`
- `src/hooks/use-composition.ts`
- `src/stores/composition-modal-store.ts`
- `src/types/composition-to-api.ts`

**Post-Implementation**: After completing this requirement, evaluate if the context description or file paths need updates. Use the appropriate API/DB query to update the context if architectural changes were made.

## Recommended Skills

Use Claude Code skills as appropriate for implementation guidance. Check `.claude/skills/` directory for available skills.

## Notes

This requirement was generated from an AI-evaluated project idea. No specific goal is associated with this idea.

## Implementation Guidelines

**IMPORTANT**: Execute the requirement immediately without asking for confirmation or approval.

**Steps**:
1. Analyze the requirement thoroughly
2. Identify all files that need to be modified or created
3. Implement all changes specified in the requirement
4. Follow implementation steps precisely
5. Run any tests if specified
6. Ensure all changes are complete before finishing

## File Structure (Next.js/React Projects)

**Feature-Specific Files** (use `app/features/<feature>` structure):
- `app/features/<feature>/components/` - Feature-specific components and UI
- `app/features/<feature>/lib/` - Feature-specific functions, utilities, helpers
- `app/features/<feature>/` - Main wrapper, index, or page file

**Reusable UI Components** (use `app/components/ui` structure):
- `app/components/ui/` - Shared, reusable UI elements across multiple features

## Test Selectors

**CRITICAL**: Add `data-testid` attributes to ALL interactive UI components for automated testing.

**Guidelines**:
- Add to all clickable elements (buttons, links, icons)
- Use descriptive kebab-case: `data-testid="submit-form-btn"`
- Include component context: `data-testid="goal-delete-btn"`, `data-testid="project-settings-modal"`
- Add to form inputs: `data-testid="email-input"`
- Add to list items: `data-testid="task-item-123"`

**Example**:
```tsx
<button onClick={handleSubmit} data-testid="create-goal-btn">
  Create Goal
</button>

<input
  type="text"
  value={title}
  onChange={handleChange}
  data-testid="goal-title-input"
/>
```

## Theming and Styling

**Before creating new UI components**:
1. Examine existing components in the project
2. Match the color scheme, spacing, and visual patterns
3. Use consistent className patterns (Tailwind CSS)
4. Follow the app's design language (glassmorphism, gradients, shadows, etc.)
5. Support dark mode if the app uses it

## Documentation Policy

**CRITICAL RULE**: Do NOT create separate documentation files (.md, README.md, docs/) for routine implementations.

**Only create documentation when**:
- Implementing a NEW major feature or module (not refactorings)
- Adding a NEW API or public interface
- Creating NEW architectural patterns
- The requirement explicitly asks for documentation

**Do NOT create documentation for**:
- Bug fixes
- Refactorings
- Small adjustments
- UI changes
- Database schema changes
- Performance improvements
- Code quality improvements

**For all implementations**: Create an implementation log entry (see next section) - this is your primary documentation.

## Implementation Logging

**CRITICAL**: After completing the implementation, create ONE log entry using the implementation-log repository.

**DO NOT**:
- ❌ Create standalone SQL scripts
- ❌ Create separate logging files
- ❌ Insert SQL directly into project databases
- ❌ Use `sqlite3` commands

**DO**:
- ✅ Use the repository function directly in a simple Node.js script
- ✅ Run the script once to create the log entry
- ✅ Delete the script after execution

**Step 1**: Create a simple logging script

```typescript
// create-log.ts (or create-log.mjs with import syntax)
import { implementationLogDb } from '@/app/db';
import { randomUUID } from 'crypto';

implementationLogDb.createLog({
  id: randomUUID(),
  project_id: '4ee93a8c-9318-4497-b7cf-05027e48f12b',
  context_id: 'ctx_1763866173808_qhzdty36n',
  requirement_name: '<requirement-file-name-without-.md>',
  title: '<2-6 words describing what was done>',
  overview: '<1-2 paragraphs: What was implemented, key files modified/created, major functionality added>',
  overview_bullets: '<bullet1>\n<bullet2>\n<bullet3>',
  tested: false,
  screenshot: null, // Will be populated if screenshot succeeds
});

console.log('✅ Implementation log created');
```

**Step 2**: Run the script

```bash
npx tsx create-log.ts
# or
node create-log.mjs
```

**Step 3**: Delete the script

```bash
rm create-log.ts
# or del create-log.ts on Windows
```

**Field Guidelines**:
- `id`: Use `randomUUID()` or `crypto.randomUUID()`
- `requirement_name`: Requirement filename WITHOUT .md extension
- `title`: 2-6 words (e.g., "User Authentication System")
- `overview`: 1-2 paragraphs describing what was done
- `overview_bullets`: 3-5 bullets separated by \n (e.g., "Added OAuth flow\nCreated auth context\nUpdated login UI")
- `tested`: Always `false` initially

**Example**:
```typescript
implementationLogDb.createLog({
  id: randomUUID(),
  project_id: 'proj-123',
  requirement_name: 'implement-dark-mode',
  title: 'Dark Mode Implementation',
  overview: 'Implemented global dark mode toggle with theme persistence. Added theme context provider, updated all UI components to support dark mode, and created settings panel for theme switching.',
  overview_bullets: 'Created ThemeProvider context\nUpdated 25+ components with dark mode styles\nAdded theme toggle in settings\nImplemented localStorage persistence',
  tested: false
});
```

## Screenshot Capture (Context-Related Only)

**Workflow**:

### Step 1: Check if Test Scenario Exists

```bash
curl -X POST "http://localhost:3000/api/tester/screenshot" \
  -H "Content-Type: application/json" \
  -d '{"contextId":"ctx_1763866173808_qhzdty36n","scanOnly":true}'
```

**If `hasScenario: false`**: Skip all remaining screenshot steps. Set `screenshot: null` in log.

### Step 2: Start Dev Server (ONLY if scenario exists)

Start your development server manually (e.g., `npm run dev`)

### Step 3: Capture Screenshot

```bash
curl -X POST "http://localhost:3000/api/tester/screenshot" \
  -H "Content-Type: application/json" \
  -d '{"contextId":"ctx_1763866173808_qhzdty36n"}'
```

### Step 4: Stop Server (CRITICAL)

Stop your development server

### Step 5: Update Log with Screenshot Path

Use the `screenshotPath` from API response in your log creation:

```typescript
screenshot: screenshotPath || null
```

**Error Handling**:
- No scenario → `screenshot: null`
- Server fails (unrelated to your code) → `screenshot: null`
- Server fails (your bugs) → Fix bugs, retry, then screenshot
- Screenshot API fails → `screenshot: null`
- **Always stop the server** to free the port for next task

## Final Checklist

Before finishing:
- [ ] All code changes implemented
- [ ] Test IDs added to interactive components
- [ ] File structure follows guidelines
- [ ] UI components match existing theme
- [ ] Implementation log entry created
- [ ] Screenshot captured (if test scenario exists)
- [ ] NO separate documentation files created (unless new major feature)

Begin implementation now.

## Implementation Guidelines

**IMPORTANT**: Execute the requirement immediately without asking for confirmation or approval.

**Steps**:
1. Analyze the requirement thoroughly
2. Identify all files that need to be modified or created
3. Implement all changes specified in the requirement
4. Follow implementation steps precisely
5. Run any tests if specified
6. Ensure all changes are complete before finishing

## File Structure (Next.js/React Projects)

**Feature-Specific Files** (use `app/features/<feature>` structure):
- `app/features/<feature>/components/` - Feature-specific components and UI
- `app/features/<feature>/lib/` - Feature-specific functions, utilities, helpers
- `app/features/<feature>/` - Main wrapper, index, or page file

**Reusable UI Components** (use `app/components/ui` structure):
- `app/components/ui/` - Shared, reusable UI elements across multiple features

## Test Selectors

**CRITICAL**: Add `data-testid` attributes to ALL interactive UI components for automated testing.

**Guidelines**:
- Add to all clickable elements (buttons, links, icons)
- Use descriptive kebab-case: `data-testid="submit-form-btn"`
- Include component context: `data-testid="goal-delete-btn"`, `data-testid="project-settings-modal"`
- Add to form inputs: `data-testid="email-input"`
- Add to list items: `data-testid="task-item-123"`

**Example**:
```tsx
<button onClick={handleSubmit} data-testid="create-goal-btn">
  Create Goal
</button>

<input
  type="text"
  value={title}
  onChange={handleChange}
  data-testid="goal-title-input"
/>
```

## Theming and Styling

**Before creating new UI components**:
1. Examine existing components in the project
2. Match the color scheme, spacing, and visual patterns
3. Use consistent className patterns (Tailwind CSS)
4. Follow the app's design language (glassmorphism, gradients, shadows, etc.)
5. Support dark mode if the app uses it

## Documentation Policy

**CRITICAL RULE**: Do NOT create separate documentation files (.md, README.md, docs/) for routine implementations.

**Only create documentation when**:
- Implementing a NEW major feature or module (not refactorings)
- Adding a NEW API or public interface
- Creating NEW architectural patterns
- The requirement explicitly asks for documentation

**Do NOT create documentation for**:
- Bug fixes
- Refactorings
- Small adjustments
- UI changes
- Database schema changes
- Performance improvements
- Code quality improvements

**For all implementations**: Create an implementation log entry (see next section) - this is your primary documentation.

## Implementation Logging

**CRITICAL**: After completing the implementation, create ONE log entry using the implementation-log repository.

**DO NOT**:
- ❌ Create standalone SQL scripts
- ❌ Create separate logging files
- ❌ Insert SQL directly into project databases
- ❌ Use `sqlite3` commands

**DO**:
- ✅ Use the repository function directly in a simple Node.js script
- ✅ Run the script once to create the log entry
- ✅ Delete the script after execution

**Step 1**: Create a simple logging script

```typescript
// create-log.ts (or create-log.mjs with import syntax)
import { implementationLogDb } from '@/app/db';
import { randomUUID } from 'crypto';

implementationLogDb.createLog({
  id: randomUUID(),
  project_id: '4ee93a8c-9318-4497-b7cf-05027e48f12b',
  requirement_name: '<requirement-file-name-without-.md>',
  title: '<2-6 words describing what was done>',
  overview: '<1-2 paragraphs: What was implemented, key files modified/created, major functionality added>',
  overview_bullets: '<bullet1>\n<bullet2>\n<bullet3>',
  tested: false,
});

console.log('✅ Implementation log created');
```

**Step 2**: Run the script

```bash
npx tsx create-log.ts
# or
node create-log.mjs
```

**Step 3**: Delete the script

```bash
rm create-log.ts
# or del create-log.ts on Windows
```

**Field Guidelines**:
- `id`: Use `randomUUID()` or `crypto.randomUUID()`
- `requirement_name`: Requirement filename WITHOUT .md extension
- `title`: 2-6 words (e.g., "User Authentication System")
- `overview`: 1-2 paragraphs describing what was done
- `overview_bullets`: 3-5 bullets separated by \n (e.g., "Added OAuth flow\nCreated auth context\nUpdated login UI")
- `tested`: Always `false` initially

**Example**:
```typescript
implementationLogDb.createLog({
  id: randomUUID(),
  project_id: 'proj-123',
  requirement_name: 'implement-dark-mode',
  title: 'Dark Mode Implementation',
  overview: 'Implemented global dark mode toggle with theme persistence. Added theme context provider, updated all UI components to support dark mode, and created settings panel for theme switching.',
  overview_bullets: 'Created ThemeProvider context\nUpdated 25+ components with dark mode styles\nAdded theme toggle in settings\nImplemented localStorage persistence',
  tested: false
});
```

## Final Checklist

Before finishing:
- [ ] All code changes implemented
- [ ] Test IDs added to interactive components
- [ ] File structure follows guidelines
- [ ] UI components match existing theme
- [ ] Implementation log entry created
- [ ] NO separate documentation files created (unless new major feature)

Begin implementation now.